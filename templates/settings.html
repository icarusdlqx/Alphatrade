{% extends "base.html" %}
{% block content %}
<h4>Settings</h4>
<form method="post">
  <article>
    <header>Core</header>
    <div class="grid">
      <label>Enabled <input type="checkbox" name="ENABLED" {% if S.ENABLED %}checked{% endif %}></label>
      <label>Max positions <input type="number" name="TARGET_POSITIONS" min="1" max="15" value="{{ S.TARGET_POSITIONS }}"></label>
      <label>Max weight per name <input type="number" step="0.01" name="MAX_WEIGHT" value="{{ S.MAX_WEIGHT }}"></label>
      <label>Turnover cap (0..1) <input type="number" step="0.01" name="TURNOVER_LIMIT" value="{{ S.TURNOVER_LIMIT }}"></label>
      <label>Min order notional ($) <input type="number" step="1" name="MIN_ORDER_NOTIONAL" value="{{ S.MIN_ORDER_NOTIONAL }}"></label>
      <label>Cash buffer (0..1) <input type="number" step="0.01" name="PORTFOLIO_CASH_BUFFER" value="{{ S.PORTFOLIO_CASH_BUFFER }}"></label>
    </div>
    <p class="muted">“Enabled” is a global kill‑switch. Turnover cap limits total portfolio reshuffle on any run.</p>
  </article>

  <article>
    <header>Timing</header>
    <div class="grid">
      <label>Windows (ET, comma‑sep) <input type="text" name="WINDOWS_ET" value="{{ S.WINDOWS_ET }}"></label>
      <label>Window tolerance (min) <input type="number" name="WINDOW_TOL_MIN" value="{{ S.WINDOW_TOL_MIN }}"></label>
      <label>Avoid near bell (min) <input type="number" name="AVOID_NEAR_OPEN_CLOSE_MIN" value="{{ S.AVOID_NEAR_OPEN_CLOSE_MIN }}"></label>
      <label>Universe mode <input type="text" name="UNIVERSE_MODE" value="{{ S.UNIVERSE_MODE }}"></label>
    </div>
  </article>

  <article>
    <header>Real‑time & Events</header>
    <div class="grid">
      <label>Use intraday sizing <input type="checkbox" name="USE_INTRADAY" {% if S.USE_INTRADAY %}checked{% endif %}></label>
      <label>Earnings gating <input type="checkbox" name="EARNINGS_GATING" {% if S.EARNINGS_GATING %}checked{% endif %}></label>
      <label>Days before earnings <input type="number" name="EARNINGS_DAYS_BEFORE" value="{{ S.EARNINGS_DAYS_BEFORE }}"></label>
      <label>Days after earnings <input type="number" name="EARNINGS_DAYS_AFTER" value="{{ S.EARNINGS_DAYS_AFTER }}"></label>
      <label>Earnings provider <input type="text" name="EARNINGS_PROVIDER" value="{{ S.EARNINGS_PROVIDER }}"></label>
      <label>Earnings API key <input type="text" name="EARNINGS_API_KEY" value="{{ S.EARNINGS_API_KEY }}"></label>
      <label>Macro dates (YYYY‑MM‑DD, comma‑sep) <input type="text" name="MACRO_DATES" value="{{ S.MACRO_DATES }}"></label>
    </div>
    <p class="muted">If you don’t set provider/API, earnings gating is skipped.</p>
  </article>

  <article>
    <header>Risk & Weighting</header>
    <div class="grid">
      <label>Regime filter <input type="checkbox" name="REGIME_FILTER" {% if S.REGIME_FILTER %}checked{% endif %}></label>
      <label>Risk‑off scalar (0..1) <input type="number" step="0.01" name="RISK_OFF_SCALAR" value="{{ S.RISK_OFF_SCALAR }}"></label>
      <label>Weighting post‑process <input type="text" name="WEIGHTING_POSTPROCESS" value="{{ S.WEIGHTING_POSTPROCESS }}"></label>
      <label>AI weight (0..1) <input type="number" step="0.01" name="AI_WEIGHT" value="{{ S.AI_WEIGHT }}"></label>
    </div>
    <p class="muted">Final weights blend GPT’s proposal with risk‑aware weights (score/vol). AI weight controls that blend.</p>
  </article>

  <footer>
    <button type="submit">Save</button>
  </footer>
</form>
{% endblock %}